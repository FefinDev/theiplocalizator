<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>TheIPLocalizator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <style>
    body {
      margin: 0;
      font-family: system-ui, sans-serif;
      background: linear-gradient(135deg, #1e1e2f, #2a2a40);
      color: #fff;
      display: flex;
      justify-content: center;
      padding: 2rem 0;
    }

    .container {
      width: 100%;
      max-width: 460px;
    }

    .card {
      background: #12121c;
      border-radius: 16px;
      padding: 24px;
      margin-bottom: 20px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.4);
    }

    h1, h3 {
      text-align: center;
      margin-top: 0;
    }

    .input-group {
      display: flex;
      gap: 8px;
      margin-bottom: 12px;
      flex-direction: column;
    }

    input {
      flex: 1;
      padding: 12px;
      border-radius: 10px;
      border: none;
      font-size: 1rem;
    }

    button {
      padding: 12px;
      border-radius: 10px;
      border: none;
      background: #4f46e5;
      color: white;
      cursor: pointer;
      font-size: 1rem;
      margin-top: 8px;
    }

    button:hover {
      background: #3730a3;
    }

    #map {
      height: 220px;
      border-radius: 12px;
      margin-top: 12px;
    }

    details {
      background: #181827;
      border-radius: 12px;
      padding: 12px;
      font-size: 0.85rem;
      color: #ddd;
    }

    summary {
      cursor: pointer;
      font-weight: 600;
      margin-bottom: 8px;
    }

    footer {
      text-align: center;
      margin-top: 12px;
      font-size: 0.75rem;
      color: #aaa;
    }

    .result {
      background: #1b1b2b;
      border-radius: 12px;
      padding: 14px;
      margin-top: 12px;
      white-space: pre-line;
      font-size: 0.95rem;
    }

    #ips {
      background: #1b1b2b;
      border-radius: 12px;
      padding: 14px;
      margin-top: 12px;
      white-space: pre-line;
      font-size: 0.95rem;
    }

    .error {
      color: #ff6b6b;
      margin-top: 8px;
      text-align: center;
    }

  </style>
</head>
<body>
<div class="container">
  <div class="card">
    <h1>üåç TheIPLocalizator</h1>
    <div class="input-group">
      <input id="ipInput" placeholder="Enter an IPv4 or IPv6 address">
      <button onclick="lookupIP()">Locate IP</button>
      <button onclick="lookupMyIP()">My IP</button>
    </div>
  </div>

  <div class="card">
    <h3>Location Information</h3>
    <div id="result" class="result" style="display:none"></div>
    <div id="map" style="display:none"></div>
    <div id="ips" class="result" style="display:none"></div>
    <div id="error" class="error"></div>
  </div>

  <div class="card">
    <details>
      <summary>üîê Security & Privacy Recommendations</summary>
      <p>
        When browsing the Internet, your IP address is exposed and can be used to obtain approximate information about your location or Internet service provider. In the wrong hands, this data may pose a risk to your privacy.
      </p>
      <p>
        We recommend avoiding untrusted websites and using additional protection measures such as a trusted VPN or privacy-focused browsers like Tor Browser.
      </p>
    </details>
  </div>

  <footer>
    Educational project ‚Ä¢ No data is stored ‚Ä¢ Approximate location only
  </footer>
</div>

<script>
  let map, marker;

  // Show user's IPv4 and IPv6
  function showUserIPs() {
    fetch("https://ipapi.co/json/")
      .then(r => r.json())
      .then(data => {
        const ipv4 = data.ip || "Not available";
        const ipv6 = data.ipv6 || "Not available";
        const ipsDiv = document.getElementById("ips");
        ipsDiv.style.display = "block";
        ipsDiv.textContent = `Your IPv4: ${ipv4}\nYour IPv6: ${ipv6}`;
      });
  }

  showUserIPs();

  async function fetchJSON(url) {
    const res = await fetch(url);
    return res.json();
  }

  async function lookupIP() {
    const ip = document.getElementById('ipInput').value.trim();
    if (!ip) return alert("Enter an IP");
    const data = await fetchJSON(`https://ipwho.is/${ip}`);
    if (!data.success) return alert("Invalid IP");
    updateUI(data);
  }

  async function lookupMyIP() {
    const data = await fetchJSON("https://ipwho.is/");
    updateUI(data);
  }

  function updateUI(data) {
    const resultDiv = document.getElementById("result");
    const mapDiv = document.getElementById("map");
    const ipsDiv = document.getElementById("ips");
    const errorDiv = document.getElementById("error");

    const ipv4 = data.type === "IPv4" ? data.ip : "Not available";
    const ipv6 = data.type === "IPv6" ? data.ip : "Not available";

    resultDiv.style.display = "block";
    resultDiv.innerHTML = `
      City: ${data.city || "‚Äî"}<br>
      Region: ${data.region || "‚Äî"}<br>
      Country: ${data.country || "‚Äî"}<br>
      ISP: ${data.connection?.isp || "‚Äî"}<br>
      <strong>IPv4:</strong> ${ipv4}<br>
      <strong>IPv6:</strong> ${ipv6}
    `;

    if (data.latitude && data.longitude) {
      mapDiv.style.display = "block";
      if (!map) {
        map = L.map('map').setView([data.latitude, data.longitude], 10);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
          attribution: '¬© OpenStreetMap'
        }).addTo(map);
        marker = L.marker([data.latitude, data.longitude]).addTo(map);
      } else {
        map.setView([data.latitude, data.longitude], 10);
        marker.setLatLng([data.latitude, data.longitude]);
      }
    }
  }
</script>
</body>
</html>
